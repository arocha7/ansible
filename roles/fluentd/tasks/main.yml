---
# tasks file for fluentd

- include_tasks: "{{ ansible_os_family }}.yml"

#
## Step 3 â€” deploying a local Elasticsearch container
#

- name: upgrade PIP
  shell: "pip install --upgrade pip"

- name: assure that Docker SDK ('docker-py') is not previously installed
  pip:
    name: ['docker-py', 'docker']
    state: absent

- name: "Docker SDK for Python: docker (Python >= 2.7) or docker-py (Python 2.6)"
  pip:
    name: docker
    state: present

- sysctl:
    name: vm.max_map_count
    value: '262144'
    state: present

- name: start Elasticsearch container
  docker_container:
    name: elasticsearch
    state: present
    image: "elasticsearch:{{ es_tag }}"
    exposed_ports:
    - 9200:9200
    - 9300:9300
    command: sleep infinity

